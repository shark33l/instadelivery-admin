(this["webpackJsonpinstadelivery-admin"]=this["webpackJsonpinstadelivery-admin"]||[]).push([[0],{80:function(e,t,a){},82:function(e,t,a){},93:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(37),c=a.n(s),i=a(133),o=a(42),l=a(48),d=a(8),u=(a(80),a(23)),j=a(130),b=a(9),m=a(2),p=n.a.createContext(),h=function(e){var t=e.children,a=Object(r.useState)(null),n=Object(b.a)(a,2),s=n[0],c=n[1],i=Object(r.useState)(!0),o=Object(b.a)(i,2),l=o[0],d=o[1];return Object(r.useEffect)((function(){var e=localStorage.getItem("accessToken");s!==e&&c(e),d(!1)}),[s]),l?Object(m.jsx)(m.Fragment,{children:"Loading..."}):Object(m.jsx)(p.Provider,{value:{currentUser:s,setCurrentUser:c},children:t})},x=(a(82),a.p+"static/media/instabuylogo.7f11e31c.png"),O=function(e){var t=n.a.useContext(p),a=t.currentUser,r=t.setCurrentUser;return Object(m.jsxs)(o.a,Object(u.a)(Object(u.a)({tag:"header",direction:"row",align:"center",justify:"between",background:"white",pad:{left:"medium",right:"small",vertical:"small"},elevation:"xsmall",style:{zIndex:"1"}},e),{},{children:[Object(m.jsxs)("div",{style:{display:"flex"},children:[Object(m.jsx)("img",{src:x,className:"app-logo",alt:"logo"}),Object(m.jsxs)("p",{style:{fontSize:"18px"},children:[Object(m.jsx)("span",{className:"app-title",children:"InstaBuy"})," Admin Console"]})]}),a&&Object(m.jsx)(j.a,{primary:!0,hoverIndicator:"accent-1",focusIndicator:!1,label:"logout",className:"button-style",onClick:function(){localStorage.removeItem("accessToken"),r(null)}})]}))},f=a(124),g=a(136),v=a(134),y=a(115),w=a(127),D=a(135),k=a(132),z=a(128),_=a(116),S=a(114),F=a(11),C=a.n(F),I=a(19),T="https://instabuy.lk/track/api/endpoints/",E={loginUser:function(){var e=Object(I.a)(C.a.mark((function e(t,a){var r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T+"login.php",e.prev=1,e.next=4,fetch("https://instabuy.lk/track/api/endpoints/login.php",{method:"POST",body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){return e.jwt?{error:!1,response:e}:{error:e.message,response:null}}),(function(e){return console.error(e),{error:e,response:null}}));case 4:r=e.sent,console.log(r),a(r.error,r.response),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0),a(e.t0,null);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,a){return e.apply(this,arguments)}}(),setTrackingData:function(){var e=Object(I.a)(C.a.mark((function e(t,a,r){var n,s,c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s in n={invoice:null,name:null,ordered_date:null,processing_date:null,ontheway_date:null,pickup_date:null,delivered_date:null},console.log(t),n)void 0!==t[s]&&t[s]&&(n[s]=t[s]);return T+"upsert.php",e.prev=4,e.next=7,fetch("https://instabuy.lk/track/api/endpoints/upsert.php",{method:"POST",headers:{Authorization:"Bearer "+a},body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){console.log(e),r(null)}),(function(e){console.log(e),r(e)}));case 7:return c=e.sent,e.abrupt("return",c);case 11:e.prev=11,e.t0=e.catch(4),console.error(e.t0),r(e.t0);case 15:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t,a,r){return e.apply(this,arguments)}}(),getAllTrackingData:function(){var e=Object(I.a)(C.a.mark((function e(){var t;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T+"read.php",e.prev=1,e.next=4,fetch("https://instabuy.lk/track/api/endpoints/read.php",{method:"GET"}).then((function(e){return e.json()})).then((function(e){return console.log(e),{error:!1,response:e}}),(function(e){return console.log(e),{error:e}}));case 4:return t=e.sent,e.abrupt("return",t);case 8:return e.prev=8,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return",{error:e.t0});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),searchTrackingData:function(){var e=Object(I.a)(C.a.mark((function e(t){var a,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=T+"read.php?s="+t,e.prev=1,e.next=4,fetch(a,{method:"GET"}).then((function(e){return e.json()})).then((function(e){return console.log(e),{error:!1,response:e}}),(function(e){return console.log(e),{error:e}}));case 4:return r=e.sent,e.abrupt("return",r);case 8:return e.prev=8,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return",{error:e.t0});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()},N=function(e){var t=n.a.useContext(p).currentUser,a=n.a.useState(0),r=Object(b.a)(a,2),s=r[0],c=r[1],i=n.a.useState({}),l=Object(b.a)(i,2),d=l[0],u=l[1],h=n.a.useState(!1),x=Object(b.a)(h,2),O=x[0],f=x[1],g=n.a.useRef(null);return n.a.useEffect((function(){var t;e.editData&&0!==Object.keys(e.editData).length&&(t=e.editData,u(t),c(1))}),[e.editData]),Object(m.jsxs)(m.Fragment,{children:[0!==s&&Object(m.jsx)(o.a,{animation:{type:"slideDown",delay:0,size:"large",duration:500},justify:"center",align:"start",pad:{bottom:"medium"},children:Object(m.jsx)(j.a,{secondary:!0,style:{color:"#1D337C"},icon:Object(m.jsx)(S.a,{color:"brand"}),label:"Add New Entry",reverse:!0,onClick:function(){u({}),c(0),g.current.reset(),e.setEditData&&e.setEditData({})},focusIndicator:!1})}),0===s?Object(m.jsx)(v.a,{level:"4",style:{marginTop:0},children:"Add New Entry"}):Object(m.jsxs)(v.a,{level:"4",style:{marginTop:0},children:["Edit Existing Entry : ",Object(m.jsx)("span",{style:{color:"#a1a1a1"},children:e.editData?e.editData.invoice:""})]}),Object(m.jsxs)(y.a,{ref:g,value:d,onChange:function(e){return u(e)},onReset:function(){u(1===s?{invoice:d.invoice}:{})},onSubmit:function(a){!function(a){a.invoice=a.invoice.toUpperCase(),a=function(e){for(var t in e)void 0!==e[t]&&e[t]||delete e[t];return e}(a),f(!0),E.setTrackingData(a,t,(function(t){t?console.log("Error occured"):(u({}),c(0),g.current.reset(),e.setLoadFirebaseData&&e.setLoadFirebaseData(!e.loadFirebaseData)),f(!1)}))}(a.value)},defaultValue:{invoice:"",name:""},children:[Object(m.jsx)(w.a,{name:"invoice",htmlFor:"invoice-id",label:Object(m.jsx)(D.a,{size:"small",children:"Invoice Number"}),required:!0,children:Object(m.jsx)(k.a,{id:"invoice-id",name:"invoice",disabled:1===s})}),Object(m.jsx)(w.a,{name:"name",htmlFor:"text-input-id",label:Object(m.jsx)(D.a,{size:"small",children:"Name"}),required:!0,children:Object(m.jsx)(k.a,{id:"name-id",name:"name"})}),Object(m.jsx)(w.a,{name:"ordered_date",htmlFor:"ordered_date-id",label:Object(m.jsx)(D.a,{size:"small",children:"Ordered Date"}),required:!0,children:Object(m.jsx)(z.a,{id:"ordered_date-id",name:"ordered_date",format:"mm/dd/yyyy"})}),d.ordered_date&&Object(m.jsx)(w.a,{name:"processing_date",htmlFor:"processing_date-id",label:Object(m.jsx)(D.a,{size:"small",children:"Processing Date"}),children:Object(m.jsx)(z.a,{id:"processing_date-id",name:"processing_date",format:"mm/dd/yyyy",calendarProps:{bounds:[d.ordered_date,new Date((new Date).setFullYear((new Date).getFullYear()+1))]}})}),d.processing_date&&Object(m.jsx)(w.a,{name:"ontheway_date",htmlFor:"ontheway_date-id",label:Object(m.jsx)(D.a,{size:"small",children:"On the Way Date"}),children:Object(m.jsx)(z.a,{id:"ontheway_date-id",name:"ontheway_date",format:"mm/dd/yyyy",calendarProps:{bounds:[d.processing_date,new Date((new Date).setFullYear((new Date).getFullYear()+1))]}})}),d.ontheway_date&&Object(m.jsx)(w.a,{name:"pickup_date",htmlFor:"pickup_date-id",label:Object(m.jsx)(D.a,{size:"small",children:"Pickup Date"}),children:Object(m.jsx)(z.a,{id:"pickup_date-id",name:"pickup_date",format:"mm/dd/yyyy",calendarProps:{bounds:[d.ontheway_date,new Date((new Date).setFullYear((new Date).getFullYear()+1))]}})}),d.pickup_date&&Object(m.jsx)(w.a,{name:"delivered_date",htmlFor:"delivered_date-id",label:Object(m.jsx)(D.a,{size:"small",children:"Delivered Date"}),children:Object(m.jsx)(z.a,{id:"delivered_date-id",name:"delivered_date",format:"mm/dd/yyyy",calendarProps:{bounds:[d.pickup_date,new Date((new Date).setFullYear((new Date).getFullYear()+1))]}})}),O?Object(m.jsxs)("div",{style:{display:"flex",marginTop:"20px"},children:[Object(m.jsx)(_.a,{}),Object(m.jsx)(D.a,{margin:{horizontal:"medium"},children:"Saving Data..."})]}):Object(m.jsxs)(o.a,{direction:"row",gap:"medium",margin:{vertical:"medium"},children:[Object(m.jsx)(j.a,{type:"submit",primary:!0,label:"Submit",className:"button-style"}),Object(m.jsx)(j.a,{type:"reset",label:"Reset",style:{color:"#1D337C"},className:"button-style"})]})]})]})},P=a(118),L=a(119),A=a(120),U=a(121),Y=a(122),J=a(131),q=a(117),M=a(123),R=["January","February","March","April","May","June","July","August","September","October","November","December"],B=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],W={formatDate:function(e){var t=new Date(e),a=t.getFullYear(),r=t.getDate(),n=R[t.getMonth()],s=B[t.getDay()];return"".concat(s,", ").concat(r," ").concat(n," ").concat(a)}},G=function(e){var t=n.a.useState({}),a=Object(b.a)(t,2),r=a[0],s=a[1],c=n.a.useState(""),i=Object(b.a)(c,2),l=i[0],d=i[1],u=n.a.useState([]),p=Object(b.a)(u,2),h=p[0],x=p[1],O=n.a.useState({page:1,startIndex:0,endIndex:9}),f=Object(b.a)(O,2),g=f[0],v=f[1],z=n.a.useState(!1),S=Object(b.a)(z,2),F=S[0],T=S[1];n.a.useEffect((function(){(function(){var e=Object(I.a)(C.a.mark((function e(){var t;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(!0),e.next=3,E.getAllTrackingData();case 3:(t=e.sent).error?console.log(t.error):x(t.response),T(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[e.loadFirebaseData]);var N=function(e,t){return e.filter((function(e){for(var a=!1,r=0,n=Object.entries(e);r<n.length;r++){var s=Object(b.a)(n[r],2),c=s[0],i=s[1];if(("name"===c||"invoice"===c)&&i.toLowerCase().includes(t.toLowerCase())){a=!0;break}var o=B(e);if(o.status.toLowerCase().includes(t.toLowerCase())||o.date.includes(t)){a=!0;break}if(W.formatDate(o.date).toLowerCase().includes(t.toLowerCase())){a=!0;break}}return a}))},R=function(){var e=Object(I.a)(C.a.mark((function e(t){var a,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(!0),e.next=3,E.getAllTrackingData();case 3:(a=e.sent).error?console.log(a.error):(r=void 0!==t?N(a.response,t):a.response,x(r)),d(t),T(!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(e){for(var t=["delivered_date","pickup_date","ontheway_date","processing_date","ordered_date"],a=["Delivered","Ready for Pickup","On the Way","Processing","Ordered"],r=["#00873D","#00C781","#FFCA58","#fa9200","#FF4040"],n={},s=0;s<t.length;s++)if(t[s]in e&&e[t[s]]){n={status:a[s],date:e[t[s]].toLocaleString(),color:r[s]};break}return n||(n={status:"Invalid Status",date:"-"}),n};return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(o.a,{fill:!0,children:[Object(m.jsxs)(o.a,{direction:"row",justify:"between",children:[Object(m.jsx)(y.a,{value:r,onChange:function(e){return s(e)},onSubmit:function(e){var t=e.value;R(t.searchTerm)},children:Object(m.jsxs)(o.a,{direction:"row",children:[Object(m.jsx)(w.a,{children:Object(m.jsx)(k.a,{placeholder:"Search by any",name:"searchTerm",icon:Object(m.jsx)(q.a,{})})}),Object(m.jsx)(j.a,{primary:!0,type:"submit",margin:{horizontal:"small",vertical:"xsmall"},label:"Search",className:"button-style"})]})}),F&&Object(m.jsx)(_.a,{size:"medium",align:"end"})]}),l&&Object(m.jsx)(o.a,{children:Object(m.jsxs)(D.a,{children:['Search results for "',l,'"']})}),Object(m.jsxs)(o.a,{margin:{vertical:"large"},children:[Object(m.jsxs)(P.a,{children:[Object(m.jsx)(L.a,{children:Object(m.jsxs)(A.a,{style:{background:"#f5f5f5"},children:[Object(m.jsx)(U.a,{scope:"col",border:"bottom",size:"medium",pad:{vertical:"small",horizontal:"small"},children:Object(m.jsx)("strong",{children:"Invoice Number"})}),Object(m.jsx)(U.a,{scope:"col",border:"bottom",size:"large",pad:{vertical:"small",horizontal:"small"},children:"Name"}),Object(m.jsx)(U.a,{scope:"col",border:"bottom",size:"medium",pad:{vertical:"small",horizontal:"small"},children:"Current Status"}),Object(m.jsx)(U.a,{scope:"col",border:"bottom",size:"xlarge",pad:{vertical:"small",horizontal:"small"},children:"Status Date"}),Object(m.jsx)(U.a,{scope:"col",border:"bottom",size:"small",pad:{vertical:"small",horizontal:"small"},align:"center",children:"Action"})]})}),Object(m.jsx)(Y.a,{children:h.length?h.map((function(t,a){return a>=g.startIndex&&a<=g.endIndex?Object(m.jsxs)(A.a,{children:[Object(m.jsx)(U.a,{scope:"row",size:"medium",border:"bottom",pad:{vertical:"medium",horizontal:"small"},children:Object(m.jsx)("strong",{children:t.invoice})}),Object(m.jsx)(U.a,{size:"large",border:"bottom",pad:{vertical:"medium",horizontal:"small"},children:t.name}),Object(m.jsx)(U.a,{size:"medium",style:{textTransform:"capitalize"},border:"bottom",pad:{vertical:"medium",horizontal:"small"},children:Object(m.jsxs)("div",{style:{display:"flex"},children:[Object(m.jsx)("div",{style:{background:B(t).color,height:"20px",width:"20px",borderRadius:"50%",margin:"-2px 10px 0px 0px"}}),B(t).status]})}),Object(m.jsx)(U.a,{size:"xlarge",border:"bottom",pad:{vertical:"medium",horizontal:"small"},children:W.formatDate(B(t).date)}),Object(m.jsx)(U.a,{size:"small",border:"bottom",pad:{vertical:"medium",horizontal:"small"},children:Object(m.jsx)(o.a,{plain:!0,children:Object(m.jsx)(j.a,{plain:!0,hoverIndicator:!0,icon:Object(m.jsx)(M.a,{}),label:"Edit",onClick:function(){return a=t,void(e.setEditData&&e.setEditData(a));var a}})})})]},t.invoice):null})):Object(m.jsx)(A.a,{children:Object(m.jsx)(U.a,{colSpan:"5",align:"center",pad:{vertical:"medium",horizontal:"small"},children:Object(m.jsx)(D.a,{children:"\ud83d\ude1f No Entries Found"})})})})]}),Object(m.jsx)(o.a,{fill:"horizontal",pad:{top:"medium"},children:Object(m.jsx)(J.a,{alignSelf:"end",onChange:function(e){var t=e.page,a=e.startIndex,r=e.endIndex;v({page:t,startIndex:a,endIndex:r-1})},step:10,numberItems:h.length})})]})]})})},V=function(e){var t=n.a.useState({}),a=Object(b.a)(t,2),r=a[0],s=a[1],c=n.a.useState(!0),i=Object(b.a)(c,2),l=i[0],d=i[1],u={vertical:{rows:["auto","auto"],columns:["auto"],areas:{add_panel:{start:[0,0],end:[0,1]},data_panel:{start:[0,1],end:[0,1]}}},horizontal:{rows:["auto"],columns:["medium","auto"],areas:{add_panel:{start:[0,0],end:[0,0]},data_panel:{start:[1,0],end:[1,0]}}}};return Object(m.jsx)(f.a.Consumer,{children:function(e){var t=["xxsmall","xsmall","small"].includes(e)?"vertical":"horizontal";return Object(m.jsxs)(g.a,{rows:u[t].rows,columns:u[t].columns,gap:"xsmall",areas:[{name:"add-panel",start:u[t].areas.add_panel.start,end:u[t].areas.add_panel.end},{name:"data-panel",start:u[t].areas.data_panel.start,end:u[t].areas.data_panel.end}],children:[Object(m.jsx)(o.a,{size:t,animation:{type:"slideUp",delay:0,size:"large",duration:500},pad:{vertical:"large",horizontal:"medium"},gridArea:"add-panel",background:"white",children:Object(m.jsx)(N,{editData:r,setEditData:s,loadFirebaseData:l,setLoadFirebaseData:d})}),Object(m.jsx)(o.a,{size:t,animation:{type:"slideUp",delay:0,size:"large",duration:500},pad:{top:"large",bottom:"medium",horizontal:"medium"},gridArea:"data-panel",background:"white",children:Object(m.jsx)(G,{setEditData:s,loadFirebaseData:l})})]})}})},H=a(71),K=function(e){var t=e.component,a=Object(H.a)(e,["component"]),n=Object(r.useContext)(p).currentUser;return Object(m.jsx)(d.b,Object(u.a)(Object(u.a)({},a),{},{render:function(e){return n?Object(m.jsx)(t,Object(u.a)({},e)):Object(m.jsx)(d.a,{to:"/login"})}}))},Q=a(125),X=a(126),Z=Object(d.f)((function(e){var t=e.history,a=Object(r.useState)({error:!1,message:""}),s=Object(b.a)(a,2),c=s[0],i=s[1],l=n.a.useState({}),u=Object(b.a)(l,2),h=u[0],x=u[1],O=Object(r.useContext)(p),f=O.currentUser,g=O.setCurrentUser,z=Object(r.useCallback)(function(){var e=Object(I.a)(C.a.mark((function e(a){var r,n;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a.email,n=a.password;try{E.loginUser({username:r,password:n},(function(e,a){!e&&a.jwt?(localStorage.setItem("accessToken",a.jwt),g(a.jwt),t.push("/")):(console.log(e),i({error:!0,message:e}))}))}catch(s){console.log(s),i({error:!0,message:s})}case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t]);return f?Object(m.jsx)(d.a,{to:"/"}):Object(m.jsxs)(o.a,{background:"white",fill:!0,align:"center",justify:"center",pad:"xlarge",children:[Object(m.jsx)(v.a,{level:"2",children:"Login"}),c.error&&Object(m.jsx)(o.a,{direction:"row",align:"center",justify:"center",fill:"horizontal",pad:"medium",children:Object(m.jsx)(Q.a,{height:"xsmall",width:"large",background:"#f8d7da",elevation:"xsmall",children:Object(m.jsx)(X.a,{pad:"medium",align:"center",justify:"center",children:Object(m.jsx)(D.a,{color:"#842029",children:c.message.toString()})})})}),Object(m.jsx)(o.a,{width:"medium",children:Object(m.jsxs)(y.a,{value:h,onSubmit:function(e){var t=e.value;z(t)},onChange:function(e){return x(e)},defaultValue:{email:"",password:""},children:[Object(m.jsx)(w.a,{name:"email",htmlFor:"email-id",label:"Email",required:!0,children:Object(m.jsx)(k.a,{id:"email-id",name:"email",type:"email"})}),Object(m.jsx)(w.a,{name:"password",htmlFor:"password-id",label:"Password",required:!0,children:Object(m.jsx)(k.a,{id:"password-id",name:"password",type:"password"})}),Object(m.jsx)(o.a,{fill:"horizontal",margin:{top:"medium"},height:"medium",children:Object(m.jsx)(j.a,{type:"submit",size:"large",primary:!0,label:"Submit",className:"button-style"})})]})})]})}));var $=function(){return Object(m.jsx)(i.a,{theme:{global:{colors:{brand:"#1D337C","accent-1":"#06164a",focus:"#06164a"},font:{family:"Poppins",size:"14px",height:"16px"}}},children:Object(m.jsx)(h,{children:Object(m.jsxs)(o.a,{fill:!0,background:"light-2",children:[Object(m.jsx)(O,{}),Object(m.jsxs)(l.a,{children:[Object(m.jsx)(K,{exact:!0,path:"/",component:V}),Object(m.jsx)(d.b,{exact:!0,path:"/login",component:Z})]})]})})})},ee=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,137)).then((function(t){var a=t.getCLS,r=t.getFID,n=t.getFCP,s=t.getLCP,c=t.getTTFB;a(e),r(e),n(e),s(e),c(e)}))};c.a.render(Object(m.jsx)(n.a.StrictMode,{children:Object(m.jsx)($,{})}),document.getElementById("root")),ee()}},[[93,1,2]]]);
//# sourceMappingURL=main.c871004e.chunk.js.map